var app=angular.module("myApp",["ui.router","tqq.ui","ui.directives","ui.service"]);app.config(["$stateProvider","$urlRouterProvider","routerData","stateInitProvider",function(e,t,r,a){t.otherwise("/404"),t.when("","/login"),t.when("/","/admin/branch"),angular.forEach(r.stateArr,function(t){e.state(a.nameInit(t.name),a.objInit(t,r.baseUrl))}),e.state("error",{url:"/404",template:'<div class="text-lg-center pd-t-lg mg-t-lg text-danger"><h1><span class="icon icon-sad2  pd-r-sm text-size-llg"></span>页面不存在404！</h1><div class="text-lg-center"><a ui-sref="admin">跳转到首页</a></div></div>'})}]);
app.constant("menuData",[{first:{icon:"glyphicon glyphicon-home",name:"店面管理",url:null},second:[{icon:"glyphicon glyphicon-list",name:"列表",url:"admin.branch"},{icon:"glyphicon glyphicon-plus",name:"添加",url:"admin.branchAdd"}]},{first:{icon:"glyphicon glyphicon-apple",name:"商品管理",url:null},second:[{icon:"glyphicon glyphicon-list",name:"列表",url:"admin.goods"},{icon:"glyphicon glyphicon-plus",name:"添加",url:"admin.goodsAdd"},{icon:"glyphicon glyphicon-stats",name:"统计",url:"admin.goodsStats"}]},{first:{icon:"glyphicon glyphicon-list-alt",name:"订单管理",url:null},second:[{icon:"glyphicon glyphicon-list",name:"列表",url:"admin.order"},{icon:"glyphicon glyphicon-plus",name:"添加",url:"admin.orderAdd"},{icon:"glyphicon glyphicon-stats",name:"统计",url:"admin.orderStats"}]}]),app.constant("routerData",{baseUrl:"./module",stateArr:[{name:"admin",viewUrl:"/common/"},{name:"login",viewUrl:"/login/"},{name:"admin.branch",viewUrl:"/branch/"},{name:"admin.branchShow/:id",viewUrl:"/branch/"},{name:"admin.branchAdd",viewUrl:"/branch/"},{name:"admin.branchEdit",viewUrl:"/branch/"},{name:"admin.goods",viewUrl:"/goods/"},{name:"admin.goodsAdd",viewUrl:"/goods/"},{name:"admin.goodsShow",viewUrl:"/goods/"},{name:"admin.goodsEdit",viewUrl:"/goods/"},{name:"admin.goodsStats",viewUrl:"/goods/"}]});
angular.module("ui.directives",[]).filter("toHtml",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).directive("eclFilter",function(){return{restrict:"EA",replace:!0,scope:{eclFilter:"=",ngModel:"=",eclClick:"&",filterTitle:"@"},link:function(e,t,a){e.$watch("ngModel",function(t,a){void 0!=t&&e.eclClick()}),e.judge=[],e.judge[0]=!0,e.update=function(t,a){t?e.ngModel=t:e.ngModel=""}},template:'<div class="ecl-select"> <div class="select-title">{{filterTitle}}</div> <span class="ecl-option" ng-class="{active:!ngModel}" ng-click="update(false,0)">全 部</span><span ng-repeat="(i,value) in eclFilter" class="ecl-option"ng-click="update(i,($index+1))" ng-class="{active:ngModel==i}">{{value}}</span> </div>'}}).directive("menu",function(){return{restrict:"EA",replace:!0,scope:{menuData:"=",isHide:"="},link:function(e,t,a){e.$watch("isHide",function(e,t){e?$("body").css("overflow-y","hidden"):$("body").css("overflow-y","")})},template:'<div class="menu-box" ng-class="{active:isHide}"><nav class="sidebar-menu"><a class="menu-first" ng-repeat-start="(key,value) in menuData track by $index"> <span><i class="{{value.first.icon}}"></i>{{value.first.name}}</span> </a> <ul class=" menu-second " ng-repeat-end ng-if="value.second.length>0"> <li ng-repeat="men in value.second track by $index"> <a ui-sref-active="active" ui-sref="{{men.url}}" ng-click="postJudge($event)"> <i class="{{men.icon}}"></i><span>{{men.name}}</span> </a> </li> </ul>  </nav></div>'}}).directive("tableList",function(){return{restrict:"EA",replace:!0,scope:{tableData:"=",tableTitle:"=",tableChecked:"=",tqqClick:"&"},link:function(e,t,a){!a.tqqClick,setTimeout(function(){var t=$(".isClick");t.children().bind("click",function(t){e.tqqClick()(e.tableData[$(this).parent().attr("data-value")],$(this).parent().attr("data-title"),$(this).parent().attr("data-value")),e.$apply()})},200)},template:'<table class="table"> <thead> <tr> <th ng-repeat="data in tableTitle track by $index" ng-if="!data.defaultHide" class="text-center">{{data.name}}</th> </tr> </thead> <tbody> <tr ng-repeat="(key,value) in tableData track by $index" class="pointer"  ng-class="{checkedNo:!tableChecked[key],checkedYes:tableChecked[key]}"> <td ng-repeat="title in tableTitle track by $index" class="isClick" ng-if="!title.defaultHide" ng-bind-html="value|crateHtml:title | toHtml" data-value="{{key}}" data-title="{{title.judge}}"></td> </tr> </tbody> </table> '}}).filter("crateHtml",["$filter",function(e){function t(e,t){var a=t.split(".");try{if(!angular.isArray(a))throw"解析字段时出错";var n=a.length;switch(n){case 0:return null;case 1:return e[a[0]]||"";case 2:return e[a[0]][a[1]]||"";case 3:return e[a[0]][a[1]][a[2]]||"";case 4:return e[a[0]][a[1]][a[2]][a[3]]||"";case 5:return e[a[0]][a[1]][a[2]][a[3]][a[4]]||""}}catch(i){return""}}function a(a,n){var i,l,r,s;r=n.split("|"),l=r[0],i=r[1].split(":"),s=i.length,angular.forEach(i,function(e,n){!(n>0)||"'"!==e.substr(0,1)&&'"'!==e.substr(0,1)||"'"!==e.substr(-1,1)&&'"'!==e.substr(-1,1)?n>0&&(i[n]=t(a,e)):i[n]=e.slice(1,-1)});try{e(i[0])}catch(c){throw i[0]+"的filter没有定义"}switch(s){case 1:return e(i[0])(t(a,l));case 2:return e(i[0])(t(a,l),i[1]);case 3:return e(i[0])(t(a,l),i[1],i[2]);case 4:return e(i[0])(t(a,l),i[1],i[2],i[3]);case 5:return e(i[0])(t(a,l),i[1],i[2],i[3],i[4]);default:return'<i style="color:red">no "filter"</i>'}}function n(e,n){return"<"!==e.substr(0,1)||"/>"!==e.substr(-1,2)&&">"!==e.substr(-1,1)?"'"!==e.substr(0,1)&&'"'!==e.substr(0,1)||"'"!==e.substr(-1,1)&&'"'!==e.substr(-1,1)?function(e,n){var i,l=e.replace(/(^\s+)|(\s+$)|(\s+)/g,"");return i=l.split("|"),i.length>1?a(n,l):t(n,i[0])}(e,n):e.slice(1,-1):e}function i(e,t){return t?angular.isArray(t)?function(e,t){var a=[];return angular.forEach(t,function(t){a.push(n(t.node,e))}),a.join("")}(e,t):angular.isString(t)?n(t,e)||"":void 0:'<span style="color:red">no "field" </span>'}return function(e,t){var a;return a=angular.isString(t.field)&&t["class"]?'<div class="'+t["class"]+'">'+i(e,t.field)+"</div>":!angular.isString(t.field)||t.judge&&"< "===t.field.substr(0,1)&&">"===t.field.substr(-1,1)?i(e,t.field):"<div>"+i(e,t.field)+"</div>"}}]);
var ser=angular.module("ui.service",[]);ser.provider("stateInit",function(){this.ctrlInit=function(e){var t=e.split(/\.|\-|\//),r=t.length;":id"==t[r-1]&&(t.length=r-=1);for(var n=0;r>n;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join("")+"Controller"},this.nameInit=function(e){var t=e.split(/\//);return t[0]},this.objInit=function(e,t){var r={},n=e.name.split(/\.|\//),i=e.name.split("."),o=i[i.length-1],l=n.length;return":id"==n[l-1]&&(n.length=l-=1),l>1?(r.url="/"+o,r.controller=this.ctrlInit(e.name),r.templateUrl=t+e.viewUrl+n[l-1]+".html"):("admin"===n[0]&&(r["abstract"]=!0),r.url="/"+n[l-1],r.controller=this.ctrlInit(e.name),r.templateUrl=t+e.viewUrl+n[l-1]+".html"),r},this.$get=function(){return{}}}),ser.service("myHttp",["$q","$http","apiUrl","$timeout","$state",function(e,t,r,n,i){function o(o,l,s,a){var c=e.defer(),u={method:o,url:r+l,cache:!1,data:"POST"==o||"PUT"==o||"DELETE"==o?s:null,params:"GET"==o?s:null};return"DELETE"==o&&(u.headers={"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"},u.transformRequest=function(e){var t=function(e){var r,n,i,o,l,s,a,c="";for(r in e)if(n=e[r],n instanceof Array)for(a=0;a<n.length;++a)l=n[a],i=r+"["+a+"]",s={},s[i]=l,c+=t(s)+"&";else if(n instanceof Object)for(o in n)l=n[o],i=r+"["+o+"]",s={},s[i]=l,c+=t(s)+"&";else void 0!==n&&null!==n&&(c+=encodeURIComponent(r)+"="+encodeURIComponent(n)+"&");return c.length?c.substr(0,c.length-1):c};return angular.isObject(e)&&"[object File]"!==String(e)?t(e):e}),t(u).success(function(e,t){if("SUCCESS"==e.res||1==e.res)c.resolve(e);else if("FAILED"==e.res){if(c.reject(e),!e.error.code)return;switch(e.error.code){case"20304":n(function(){i.go("login"),sessionStorage.clear()},1e3);break;case"20305":n(function(){i.go("login"),sessionStorage.clear()},1e3);break;case"10008":}}}).error(function(e,t){}),c.promise}return o}]).filter("toStatus",function(){return function(){}}).filter("toPhone",function(){return function(){}});
app.controller("AdminBranchController",["$scope","branchApi",function(e,a){e.filterData={sjfj:"选项一",asd:"选项二",123:"选项三"},e.listData={data:[{branchId:"md002",name:"门店",managePer:{name:"小A"},tel:"14874634475",address:"这里是地址"},{branchId:"md003",name:"XX店",managePer:{name:"小W"},tel:"13545456565",address:"YOU地址"},{branchId:"md004",name:"YY店",managePer:{name:"小E"},tel:"18598457564",address:"LIme地址"},{branchId:"md005",name:"DD店",managePer:{name:"小T"},tel:"18545459989",address:"address"},{branchId:"md005",name:"DD店",managePer:{name:"小T"},tel:"18545459989",address:"address"},{branchId:"md005",name:"DD店",managePer:{name:"小T"},tel:"18545459989",address:"address"},{branchId:"md005",name:"DD店",managePer:{name:"小T"},tel:"18545459989",address:"address"},{branchId:"md005",name:"DD店",managePer:{name:"小T"},tel:"18545459989",address:"address"},{branchId:"md005",name:"DD店",managePer:{name:"小T"},tel:"18545459989",address:"address"},{branchId:"md005",name:"DD店",managePer:{name:"小T"},tel:"18545459989",address:"address"}]},e.title=[{name:"多选",lock:!0,field:'<div class="checkCtrl"></div>',judge:"CHECKED"},{name:"门店编号",defaultHide:!1,lock:!0,field:"branchId",judge:"SHOW","class":"text-primary"},{name:"门店名称",lock:!0,field:"name"},{name:"负责人",defaultHide:!0,lock:!0,field:"managePer.name"},{name:"门店电话",lock:!0,field:"tel",judge:"eddk"},{name:"门店地址",lock:!0,field:"address","class":"width-100 omit"},{name:"门店类型",lock:!1,field:'branchType | toStatus:"BRANCH_TYPE"'},{name:"经营状态",defaultHide:!1,lock:!1,field:"status|toStatus:BRANCH_STATUS"},{name:"分配员工",lock:!0,field:'"<a class="edit">分配员工</a>"',judge:"STAFF"},{name:"项目管理",lock:!0,field:[{node:'<div class="edit">项目管理</div>',judge:""}]},{name:"操作",defaultHide:!0,show:!0,field:[{node:'<button class="btn btn-xs btn-primary border-radius-none" title="编辑"><i class="glyphicon glyphicon-edit"></i></button>',judge:"EDIT"},{node:'<button class="btn btn-xs btn-danger border-radius-none" title="删除"><i class="glyphicon glyphicon-trash"></i></button>',judge:"DELETE"}]}],e.checkModel=[!0],e.operation=function(a,d,n){switch(d){case"CHECKED":e.checkModel[n]=!e.checkModel[n];break;case"SHOW":e.listData.data[n].name="1231231"}}}]),app.controller("AdminBranchShowController",["$scope",function(e){}]),app.controller("AdminBranchAddController",["$scope",function(e){}]),app.controller("AdminBranchEditController",["$scope",function(e){}]);
app.factory("branchApi",["myHttp",function(t){var n={};return n.getList=function(n){return t("GET","branch",n)},n}]);

